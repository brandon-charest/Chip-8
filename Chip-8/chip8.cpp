#include "chip8.h"

/*
see http://devernay.free.fr/hacks/chip8/C8TECH10.HTM#2.4
for more info

Example of chip 8 fonts
"0"			Binary			Hex
****		11110000		0xF0
*  *		10010000		0x90
*  *		10010000		0x90
*  *		10010000		0x90
****		11110000		0xF0

*/
array<uint8_t, 80> chip8_fontset =
{
	0xF0, 0x90, 0x90, 0x90, 0xF0, //0
	0x20, 0x60, 0x20, 0x20, 0x70, //1
	0xF0, 0x10, 0xF0, 0x80, 0xF0, //2
	0xF0, 0x10, 0xF0, 0x10, 0xF0, //3
	0x90, 0x90, 0xF0, 0x10, 0x10, //4
	0xF0, 0x80, 0xF0, 0x10, 0xF0, //5
	0xF0, 0x80, 0xF0, 0x90, 0xF0, //6
	0xF0, 0x10, 0x20, 0x40, 0x40, //7
	0xF0, 0x90, 0xF0, 0x90, 0xF0, //8
	0xF0, 0x90, 0xF0, 0x10, 0xF0, //9
	0xF0, 0x90, 0xF0, 0x90, 0x90, //A
	0xE0, 0x90, 0xE0, 0x90, 0xE0, //B
	0xF0, 0x80, 0x80, 0x80, 0xF0, //C
	0xE0, 0x90, 0x90, 0x90, 0xE0, //D
	0xF0, 0x80, 0xF0, 0x80, 0xF0, //E
	0xF0, 0x80, 0xF0, 0x80, 0x80  //F
};

chip8::chip8()
{
}


chip8::~chip8()
{
}

void chip8::emulateCycle()
{
}

void chip8::debugRender()
{
}

bool chip8::loadApplication(string const fileName)
{
	return false;
}

void chip8::init()
{
	// program counter starts at memory location 512 (0x200) 
	m_program_counter = 0x200;
	m_opcode = 0;
	m_index_register = 0;
	m_stack_pointer = 0;
	m_delay_timer = 0;
	m_sound_timer = 0;

	gfx = {};
	key = {};
	m_V = {};
	m_memory = {};
	m_stack = {};
	
	// load fontset to memory
	for (int i = 0; i < sizeof(chip8_fontset); ++i)
	{
		m_memory[i] = chip8_fontset[i];
	}

	drawFlag = true;
}
